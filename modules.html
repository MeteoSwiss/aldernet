
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Modules &#8212; Aldernet 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Usage" href="usage.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this heading">¶</a></h1>
<section id="module-aldernet.training">
<span id="main-script"></span><h2>Main Script<a class="headerlink" href="#module-aldernet.training" title="Permalink to this heading">¶</a></h2>
<p>Train a U-Net based on COSMO-1e input data.</p>
<p>This script loads and processes input data and trains a U-Net model to predict target
species data using COSMO-1e input data. The model is trained and evaluated using the
training and validation data, and the best model is saved. Predictions are then made
using the saved model on the validation data, and a report is generated with the
predictions. The report is then converted to an html file using an R script.</p>
<section id="id1">
<h3>Modules:<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>socket: Provides a way to get the hostname of the computer the script is running</dt><dd><p>on.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>subprocess: Provides a way to run the R script to convert the report to an html</dt><dd><p>file.</p>
</dd>
</dl>
</li>
<li><p>git: Provides a way to get the SHA of the current git commit.</p></li>
<li><p>pyprojroot: Provides a way to get the root directory of the project.</p></li>
<li><p>tensorflow: Provides a way to set up the tensorflow backend and random seed.</p></li>
</ul>
</div></blockquote>
</section>
<section id="first-party-modules">
<h3>First-party Modules:<a class="headerlink" href="#first-party-modules" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>aldernet.utils.load_data: Provides a way to load the training and validation data.</p></li>
<li><dl class="simple">
<dt>aldernet.utils.save_predictions_and_generate_report: Provides a way to save the</dt><dd><p>predictions and generate a report with them.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>aldernet.utils.setup_output_directory: Provides a way to set up the output</dt><dd><p>directory.</p>
</dd>
</dl>
</li>
<li><p>aldernet.utils.tf_setup: Provides a way to set up the tensorflow backend.</p></li>
<li><p>aldernet.utils.train_and_evaluate_model: Provides a way to train and evaluate the
model.</p></li>
</ul>
</div></blockquote>
</section>
<section id="variables">
<h3>Variables:<a class="headerlink" href="#variables" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>repo: The git repository object for the project.</p></li>
<li><p>sha: The SHA of the current git commit.</p></li>
<li><p>hostname: The hostname of the computer the script is running on.</p></li>
<li><dl class="simple">
<dt>settings: A dictionary containing the settings for the script. The keys are:</dt><dd><ul>
<li><p>“input_species”: The species to use for input data.</p></li>
<li><p>“target_species”: The species to predict.</p></li>
<li><p>“retrain_model”: Whether to retrain the model or use a saved model.</p></li>
<li><p>“tune_with_ray”: Whether to use Ray for hyperparameter tuning.</p></li>
<li><p>“zoom”: The zoom level to use for the input data.</p></li>
<li><p>“noise_dim”: The dimension of the noise vector to use for the generator.</p></li>
<li><p>“epochs”: The number of epochs to train the model for.</p></li>
<li><p>“shuffle”: Whether to shuffle the training data before each epoch.</p></li>
<li><p>“add_weather”: Whether to add weather data to the input data.</p></li>
<li><p>“conv”: Whether to use convolutional layers instead of dense layers.</p></li>
<li><p>“members”: The number of ensemble members to use.</p></li>
<li><dl class="simple">
<dt>“device”: A dictionary containing the device to use for training. The keys</dt><dd><p>are:
- “gpu”: The number of the GPU to use for training.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>data_train: The training data.</p></li>
<li><p>data_valid: The validation data.</p></li>
<li><p>run_path: The path to the output directory for the script.</p></li>
<li><p>best_model: The best model obtained during training.</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="module-aldernet.utils">
<span id="utility-functions"></span><h2>Utility Functions<a class="headerlink" href="#module-aldernet.utils" title="Permalink to this heading">¶</a></h2>
<p>Provide all required functions for the training script.</p>
<section id="functions">
<h3>Functions:<a class="headerlink" href="#functions" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>build_unet(conv: bool=True) -&gt; tf.keras.Model: builds a UNet model for predicting</dt><dd><p>pollenconcentrations.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cbr(filters, name=None) -&gt; Sequential: Creates a convolutional block with batch</dt><dd><p>normalization and leaky ReLU activation.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>compile_generator(height, width, weather_features, noise_dim, filters): Compiles a</dt><dd><p>generator model using Tensorflow with the specified parameters.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>create_batcher(data: xarray.Dataset, batch_size: int, add_weather: bool, shuffle:</dt><dd><p>bool) -&gt; Batcher: creates a batcher object for the given data and parameters.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>create_optimizer(learning_rate: float, beta_1: float, beta_2: float)</dt><dd><p>-&gt;tf.keras.optimizers.Adam: creates an optimizer object for the model.</p>
</dd>
</dl>
</li>
<li><p>define_filters(zoom: str) -&gt; List[int]: Define the filters based on the provided zoom.</p></li>
<li><dl class="simple">
<dt>down(filters, name=None) -&gt; Sequential: Creates a downsampling block with</dt><dd><p>convolutional layer, batch normalization, and leaky ReLU activation.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>generate_report(df: pd.DataFrame, settings: Dict[str, Union[str, int, float, bool]])</dt><dd><p>-&gt; None: Generate a report based on the provided dataframe and settings.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>get_callbacks(run_path: str, sha: str) -&gt; List[ray.tune.callback.TrialCallback]: Get</dt><dd><p>the callbacks based on the provided run path and sha.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>get_scheduler(settings: Dict[str, Union[str, int, float, bool]]) -&gt;</dt><dd><p>ray.tune.schedulers.asha.ASHAScheduler: Get the ASHAScheduler based on the provided
settings.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>get_tune_config(run_path: str) -&gt; Dict[str, Union[str, Dict[str, str], float]]: Get</dt><dd><p>the Tune configuration based on the provided run path.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>load_data(hostname: str, settings: Dict[str, Union[str, int, float, bool]]) -&gt;</dt><dd><p>Tuple[xr.Dataset, xr.Dataset]: Load data based on the provided hostname and
settings.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>load_pretrained_model() -&gt; keras.engine.sequential.Sequential: Load a pre-trained</dt><dd><p>model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>predict_season(best_model: tf.keras.Model, data_valid: xr.Dataset, noise_dim: int,</dt><dd><p>add_weather: bool) -&gt; np.ndarray: predicts the pollen season with the best model and
returns a numpy array of predicted values.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>prepare_generator(run_path: str, settings: Dict[str, Union[str, int, float, bool]],</dt><dd><p>data_train: xr.Dataset) -&gt; keras.engine.training.Model: Prepare the generator based
on the provided settings and data.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>read_scaling_data() -&gt; Tuple[float, float]: reads scaling data from a file and returns</dt><dd><p>a tuple containing the center and scale.</p>
</dd>
</dl>
</li>
<li><p>rsync_mlruns(run_path: str) -&gt; None: Rsync the mlruns based on the provided run path.</p></li>
<li><dl class="simple">
<dt>save_generator_summary_and_plot(run_path: str, generator: keras.engine.training.Model)</dt><dd><p>-&gt; None: Save the generator summary and plot based on the provided run path and
generator.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>save_predictions_and_generate_report(settings: Dict[str, Union[str, int, float,</dt><dd><p>bool]], best_model: keras.engine.sequential.Sequential, data_valid: xr.Dataset) -&gt;
None: Save the predictions and generate the report based on the provided settings,
best_model, and data_valid.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>setup_directories(run_path: str, tune_trial: str) -&gt; None: creates directories for</dt><dd><p>visualizations.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>setup_output_directory(settings: Dict[str, Union[str, int, float, bool]]) -&gt; str: Set</dt><dd><p>up the output directory based on the provided settings.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>train_and_evaluate_model(run_path: str, settings: Dict[str, Union[str, int, float,</dt><dd><p>bool]], data_train: xr.Dataset, data_valid: xr.Dataset, sha: str) -&gt;
keras.engine.sequential.Sequential: Train and evaluate the model based on the
provided settings, data, and run path.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>train_epoch(generator: tf.keras.Model, optimizer_gen: tf.keras.optimizers.Optimizer,</dt><dd><p>data_train:Batcher, noise_dim: int, add_weather: bool, center: float, scale: float,
epoch: tf.Variable,step: tf.Variable, run_path: str, tune_trial: str) -&gt; np.ndarray:
trains the model for one epoch and returns a numpy array of loss values.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>train_model_simple(data_train: xr.Dataset, data_valid: xr.Dataset, epochs: int,</dt><dd><p>add_weather: bool, conv: bool=True) -&gt; tf.keras.Model: trains a simple model for
predicting pollen concentrations and returns the trained model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>train_model(config: Dict[str, float], generator: tf.keras.Model, data_train:</dt><dd><p>Batcher,data_valid: Batcher, run_path: str, noise_dim: int, add_weather: bool,
shuffle: bool) -&gt; None: trains the model using a configuration dictionary and saves
the best model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>train_step(generator, optimizer_gen, input_train, target_train, weather_train,</dt><dd><p>noise_dim, add_weather): Performs one training step for the generator of a NNet to
generate images of pollen concentrations in the air given an input image of trees
and weather data.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>train_with_ray_tune(run_path: str, settings: Dict[str, Union[str, int, float, bool]],</dt><dd><p>data_train: xr.Dataset, data_valid: xr.Dataset, sha: str) -&gt;
keras.engine.sequential.Sequential: Train the model using Ray Tune based on the
provided settings, data, and run path.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>train_without_ray_tune(settings: Dict[str, Union[str, int, float, bool]], data_train:</dt><dd><p>xr.Dataset, data_valid: xr.Dataset) -&gt; keras.engine.sequential.Sequential: Train the
model without Ray Tune based on the provided settings and data.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>up(filters, name=None) -&gt; Sequential: Creates an upsampling blockwith transposed</dt><dd><p>convolutional layer, batch normalization, and leaky ReLU activation.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>validate_epoch(generator: tf.keras.Model, data_valid: Batcher, noise_dim: int,</dt><dd><p>add_weather: bool, center: float, scale: float, epoch: tf.Variable, step_valid: int,
run_path: str, tune_trial: str) -&gt; Tuple[np.ndarray, int]: validates the model for
one epoch and returns a tuple containing a numpy array of loss values and the step
number.</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Permalink to this heading">¶</a></h3>
<p>All functions and classes defined in this script.</p>
<p>COPYRIGHT (c) 2022 MeteoSwiss, contributors listed in AUTHORS. Distributed under the
terms of the BSD 3-Clause License. SPDX-License-Identifier: BSD-3-Clause</p>
<p>This docstring was autogenerated by GPT-4.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.build_unet">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">build_unet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#build_unet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.build_unet" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a U-Net model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>conv (bool): Whether to use convolutional blocks.</p>
</dd>
<dt>Returns:</dt><dd><p>tf.keras.Model: U-Net model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.cbr">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">cbr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequential</span></span></span><a class="reference internal" href="_modules/aldernet/utils.html#cbr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.cbr" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Convolution-BatchNorm-ReLU block using the Keras Sequential API.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>filters (int): Number of filters in the Conv2D layer. name (str): Optional name
for the block.</p>
</dd>
<dt>Returns:</dt><dd><p>Sequential: A Keras Sequential model representing the CBR block.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.compile_generator">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">compile_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weather_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#compile_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.compile_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile a generator model for image-to-image translation using Keras API.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>height (int): Height of the input images. width (int): Width of the input
images. weather_features (int): Number of weather features in the weather input.
noise_dim (int): Dimensionality of the noise input. filters (List[int]): Number
of filters in each layer of the generator.</p>
</dd>
<dt>Returns:</dt><dd><p>Model: A Keras Model representing the compiled generator model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.create_batcher">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">create_batcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_weather</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#create_batcher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.create_batcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Batcher object for the given data.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data (Tuple[Tensor]): A tuple of Tensors representing the input and target data.
batch_size (int): Batch size for training. add_weather (bool): Whether to add
weather data to the input. shuffle (bool): Whether to shuffle the data during
training.</p>
</dd>
<dt>Returns:</dt><dd><p>Batcher: A Batcher object for the given data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.create_optimizer">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">create_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#create_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.create_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and returns an Adam optimizer with given hyperparameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>learning_rate (float): The learning rate for the optimizer. beta_1 (float): The
exponential decay rate for the first moment estimates. beta_2 (float): The
exponential decay rate for the second-moment estimates.</p>
</dd>
<dt>Returns:</dt><dd><p>tf.keras.optimizers.Optimizer: An instance of the Adam optimizer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.define_filters">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">define_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#define_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.define_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the filters for the generator model based on the specified zoom level.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>zoom (str): The zoom level.</p>
</dd>
<dt>Returns:</dt><dd><p>list: A list containing the filter values for the generator model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.down">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">down</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequential</span></span></span><a class="reference internal" href="_modules/aldernet/utils.html#down"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.down" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a down-sampling block using the Keras Sequential API.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>filters (int): Number of filters in the Conv2D layer. name (str): Optional name
for the block.</p>
</dd>
<dt>Returns:</dt><dd><p>Sequential: A Keras Sequential model representing the down-sampling block.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.generate_report">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">generate_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#generate_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.generate_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a report summarizing the experiment results.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>df (pandas.core.frame.DataFrame): A dataframe containing the predicted and
observed values.
settings (dict): Dictionary of settings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.get_callbacks">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">get_callbacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#get_callbacks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.get_callbacks" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the MLflow logger callback for logging the experiment results.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>run_path (str): Path to the output directory for storing results. sha (str): A
string containing the Git commit hash for the current code.</p>
</dd>
<dt>Returns:</dt><dd><p>list: A list containing the MLflow logger callback.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.get_runtime_env">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">get_runtime_env</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#get_runtime_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.get_runtime_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the runtime environment for Ray Tune.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>dict: A dictionary containing the working directory and excluded files and
directories.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.get_scheduler">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">get_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#get_scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.get_scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the scheduler for Ray Tune.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>settings (dict): Dictionary of settings.</p>
</dd>
<dt>Returns:</dt><dd><p>ray.tune.schedulers.AsyncHyperBandScheduler: The scheduler for hyperparameter
tuning.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.get_tune_config">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">get_tune_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#get_tune_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.get_tune_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the configuration settings for Ray Tune.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>None</p>
</dd>
<dt>Returns:</dt><dd><p>dict: A dictionary containing the learning rate, beta values, and MLflow
settings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.load_data">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hostname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load training and validation data for the specified hostname and zoom level.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>hostname (str): Name of the host to load data from. settings (dict): Dictionary
of settings, including zoom level.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: A tuple of two xarray datasets containing the training and validation
data.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If the hostname is not recognized.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.load_pretrained_model">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">load_pretrained_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#load_pretrained_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.load_pretrained_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a pretrained neural network model.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>tensorflow.python.keras.engine.functional.Functional: The pretrained neural
network model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.predict_season">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">predict_season</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_weather</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#predict_season"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.predict_season" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the trained <cite>best_model</cite> to predict the full pollen season for <cite>data_valid</cite>.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>best_model (keras.Model): The trained U-Net model. data_valid (xarray.Dataset):
The validation data. noise_dim (int): The dimensionality of the noise vector.
add_weather (bool): Whether or not to include weather data.</p>
</dd>
<dt>Returns:</dt><dd><p>predictions (ndarray): The predicted pollen season.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.prepare_generator">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">prepare_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#prepare_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.prepare_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the generator model for training the NNet.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>run_path (str): Path to the output directory for storing results. settings
(dict): Dictionary of settings. data_train (xarray.Dataset): Training data.</p>
</dd>
<dt>Returns:</dt><dd><p>tensorflow.python.keras.engine.functional.Functional: The compiled generator
model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.read_scaling_data">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">read_scaling_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#read_scaling_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.read_scaling_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and returns the center and scale values from scaling.txt file.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>Tuple[float, float]: A tuple of center and scale values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.rsync_mlruns">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">rsync_mlruns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#rsync_mlruns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.rsync_mlruns" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy the MLflow run data to the current working directory.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>run_path (str): Path to the output directory for storing results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.save_generator_summary_and_plot">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">save_generator_summary_and_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#save_generator_summary_and_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.save_generator_summary_and_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a summary of the generator model and a visualization of its architecture.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>run_path (str): Path to the output directory for storing results.
generator(tensorflow.python.keras.engine.functional.Functional): The generator
model to summarize and plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.save_predictions_and_generate_report">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">save_predictions_and_generate_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_valid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#save_predictions_and_generate_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.save_predictions_and_generate_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the predicted and observed values to a CSV file and generate a report.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>settings (dict): Dictionary of settings.
best_model(tensorflow.python.keras.engine.functional.Functional): The trained
neural network model.
data_valid (xarray.Dataset): Validation data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.setup_directories">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">setup_directories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_trial</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#setup_directories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.setup_directories" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the directory structure for saving visualization images.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>run_path (str): Path to the run directory. tune_trial (str): Trial ID for
hyperparameter tuning.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.setup_output_directory">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">setup_output_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#setup_output_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.setup_output_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new output directory and return the path to the new directory.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>settings (dict): Dictionary of settings.</p>
</dd>
<dt>Returns:</dt><dd><p>str: The path to the new output directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.tf_setup">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">tf_setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#tf_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.tf_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up Tensorflow to use GPU memory growth.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.train_and_evaluate_model">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">train_and_evaluate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#train_and_evaluate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.train_and_evaluate_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Train and evaluate a neural network model using the specified data and settings.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>run_path (str): Path to the output directory for storing results. settings
(dict): Dictionary of settings. data_train (xarray.Dataset): Training data.
data_valid (xarray.Dataset): Validation data. sha (str): A string containing the
Git commit hash for the current code.</p>
</dd>
<dt>Returns:</dt><dd><p>tensorflow.python.keras.engine.functional.Functional: The trained neural network
model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.train_epoch">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_gen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_weather</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_trial</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#train_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.train_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the generator for one epoch and returns the loss values.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>generator (tf.keras.Model): The generator model. optimizer_gen
(tf.keras.optimizers.Optimizer): The generator optimizer. data_train (Batcher):
The training data batcher. noise_dim (int): The dimensionality of the noise
vector. add_weather (bool): If True, the weather data is included in training.
center (float): The center value for the scaling. scale (float): The scale value
for the scaling. epoch (tf.Variable): The current epoch. step (tf.Variable): The
current step. run_path (str): The path to the directory where the output files
will be stored. tune_trial (str): The name of the current Tune trial.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: An array of loss values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.train_model">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_weather</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.train_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a model on the training data, with validation on the validation data.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>config (Dict[str, Any]): Configuration dictionary. generator (tf.keras.Model):
Generator model. data_train (xr.Dataset): Training data. data_valid
(xr.Dataset): Validation data. run_path (str): Path to save the model
checkpoints. noise_dim (int): Dimension of the noise input. add_weather (bool):
Whether to add weather to the input data. shuffle (bool): Whether to shuffle the
training data.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.train_model_simple">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">train_model_simple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_weather</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#train_model_simple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.train_model_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a simple U-Net model on <cite>data_train</cite> and validate on <cite>data_valid</cite>.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data_train (Batcher): Training data.
data_valid (Batcher): Validation data.
epochs (int): Number of epochs to train the model for. add_weather (bool):
Whether or not to include weather data. conv (bool, optional): Whether to use
convolutional layers (default is True).</p>
</dd>
<dt>Returns:</dt><dd><p>model (keras.Model): The trained U-Net model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.train_step">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_gen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weather_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_weather</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one training step of the generator of a NNet using the given inputs.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>generator (Model): The Keras Model representing the generator. optimizer_gen
(Optimizer): The optimizer for the generator. input_train (Tensor): The input
tensor for the generator. target_train (Tensor): The target tensor for the
generator. weather_train (Tensor): The weather tensor for the generator.
noise_dim (int): Dimensionality of the noise input. add_weather (bool): Whether
to add the weather input to the generator.</p>
</dd>
<dt>Returns:</dt><dd><p>float: The loss of the generator on the given inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.train_with_ray_tune">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">train_with_ray_tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#train_with_ray_tune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.train_with_ray_tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a neural network model using Ray Tune for hyperparameter tuning.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>run_path (str): Path to the output directory for storing results. settings
(dict): Dictionary of settings. data_train (xarray.Dataset): Training data.
data_valid (xarray.Dataset): Validation data. sha (str): A string containing the
Git commit hash for the current code.</p>
</dd>
<dt>Returns:</dt><dd><p>tensorflow.python.keras.engine.functional.Functional: The trained neural network
model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.train_without_ray_tune">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">train_without_ray_tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">settings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_valid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#train_without_ray_tune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.train_without_ray_tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a neural network model without using Ray Tune for hyperparameter tuning.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>settings (dict): Dictionary of settings. data_train (xarray.Dataset): Training
data. data_valid (xarray.Dataset): Validation data.</p>
</dd>
<dt>Returns:</dt><dd><p>tensorflow.python.keras.engine.functional.Functional: The trained neural network
model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.up">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequential</span></span></span><a class="reference internal" href="_modules/aldernet/utils.html#up"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.up" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an up-sampling block using the Keras Sequential API.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>filters (int): Number of filters in the Conv2DTranspose layer. name (str):
Optional name for the block.</p>
</dd>
<dt>Returns:</dt><dd><p>Sequential: A Keras Sequential model representing the up-sampling block.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.validate_epoch">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">validate_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_weather</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune_trial</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#validate_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.validate_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the generator for one epoch on validation data and return the loss.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>generator (tf.keras.Model): The generator model. data_valid (Batcher): The
validation data batcher. noise_dim (int): The dimensionality of the noise
vector. add_weather (bool): If True, the weather data is included in training.
center (float): The center value for the scaling. scale (float): The scale value
for the scaling. epoch (tf.Variable): The current epoch. step_valid (int): The
current validation step. run_path (str): The path to the directory where the
output files will be stored. tune_trial (str): The name of the current Tune
trial.</p>
</dd>
<dt>Returns:</dt><dd><p>Tuple[np.ndarray, int]: A tuple of loss values and the current validation step.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aldernet.utils.write_png">
<span class="sig-prename descclassname"><span class="pre">aldernet.utils.</span></span><span class="sig-name descname"><span class="pre">write_png</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretty</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/utils.html#write_png"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.utils.write_png" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an image in PNG format to a file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>image (Tensor): A 3-tuple of Tensors representing the input, target, and
predicted images. path (str): Path to the output file. pretty (bool): Whether to
create a pretty visualization of the image.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-aldernet.data.data_utils">
<span id="data-preparation"></span><h2>Data Preparation<a class="headerlink" href="#module-aldernet.data.data_utils" title="Permalink to this heading">¶</a></h2>
<p>Helper functions to import and pre-process zarr archives.</p>
<dl class="py class">
<dt class="sig sig-object py" id="aldernet.data.data_utils.Batcher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aldernet.data.data_utils.</span></span><span class="sig-name descname"><span class="pre">Batcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_weather</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/data/data_utils.html#Batcher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.data.data_utils.Batcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates data for Keras.</p>
<dl class="py method">
<dt class="sig sig-object py" id="aldernet.data.data_utils.Batcher.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aldernet/data/data_utils.html#Batcher.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.data.data_utils.Batcher.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Update indexes after each epoch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="aldernet.data.data_utils.Params">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aldernet.data.data_utils.</span></span><span class="sig-name descname"><span class="pre">Params</span></span><a class="reference internal" href="_modules/aldernet/data/data_utils.html#Params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.data.data_utils.Params" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve selected weather parameters.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="aldernet.data.data_utils.Stations">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aldernet.data.data_utils.</span></span><span class="sig-name descname"><span class="pre">Stations</span></span><a class="reference internal" href="_modules/aldernet/data/data_utils.html#Stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#aldernet.data.data_utils.Stations" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the measurement stations.</p>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Aldernet</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Aldernet</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-aldernet.training">Main Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-aldernet.utils">Utility Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-aldernet.data.data_utils">Data Preparation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="usage.html" title="previous chapter">Usage</a></li>
      <li>Next: <a href="contributing.html" title="next chapter">Contributing</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, MeteoSwiss.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/modules.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>